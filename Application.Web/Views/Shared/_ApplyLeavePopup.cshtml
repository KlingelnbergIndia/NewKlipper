@model Application.Web.Models.LeaveViewModel
@{
    var leaveTypes = @Model.GetAllLeaveTypes();
    var isLeaveCountZero = @Model.GetAppliedLeaves.Count == 0;
}

<div class="modal fade" id="ApplyLeaveModal" role="dialog">
    <div class="modal-dialog modal-sm">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal">&times;</button>
                <h3 class="modal-title" id="popupDateSpan"> Apply Leave</h3>
            </div>
            <div id="ModalBody" style="margin-left:9px;margin-right:10px">
                <div class="col-md-12">
                        <div class="col-md-6"  style="margin-top:8px;">
                            <label for="from">From</label>
                            <input type="date" class="form-control input-sm"
                                   value="@DateTime.Now.ToString("yyyy-MM-dd")"
                                   min="@DateTime.Today.AddYears(-1).ToString("yyyy-MM-dd")"
                                   max="@DateTime.Today.AddYears(1).ToString("yyyy-MM-dd")"
                                   asp-for="@Model.FromDate"
                                   id="FromDate"
                                   style="width:150px;"
                                   required>
                        </div>
                        <div class="col-md-6"  style="margin-top:8px;">
                            <label for="to">To</label>
                            <input type="date" class="form-control input-sm "
                                   value="@DateTime.Now.ToString("yyyy-MM-dd")"
                                   min="@DateTime.Today.AddYears(-1).ToString("yyyy-MM-dd")"
                                   max="@DateTime.Today.AddYears(1).ToString("yyyy-MM-dd")"
                                   style="width:150px;"
                                   asp-for="@Model.ToDate" id="ToDate"
                                   required>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group" style="width:200px;margin-top:14px;">
                                <label>Leave Type</label>
                                <select id="LeaveType" name="leaveType" class="form-control input-sm" asp-for="@Model.LeaveType" style="width:150px;" required>
                                    @foreach (var leave in leaveTypes)
                                    {
                                        <option value="@leave">@leave</option>
                                    }
                                </select>

                            </div>
                        </div>
                        <div class="col-md-6 form-inline" style="margin-top:42px;">
                            <label class="checkbox"><input type="checkbox" id="IsHalfDay" value="true" name="IsHalfDay"
                                            asp-for="@Model.IsHalfDay" style="margin-right:5px;">Half Day</label>
                         </div>
                            <div class="col-md-12">
                                <div class="form-group">
                                    <label>Remark</label>
                                    <textarea asp-for="@Model.Remark" id="Remark" class="form-control input-sm" placeholder="Remark" rows="6" required></textarea>
                                    <span asp-validation-for="@Model.Remark" class="text-danger input-sm"></span>
                                </div>
                            </div>
                            <div class="form-group">
                                <input type="submit" value="submit" onclick="checkDateForHalfDay('applyLeave')" class="btn btn-default btn-info pull-right" />
                            </div>
                </div>

            </div>
            <div class="modal-footer">
                <div class="form-group">
                </div>
            </div>
        </div>
    </div>
</div>

<script type="text/javascript">

    $(document).ajaxError(function (e, xhr, settings) {
        if (xhr.status == 401) {
            alert("Your Session time expired. Please login again.");
            window.location = "/";
        }
    });

    function dateToYMD(date) {
        try {
            var strArray = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];
            var d = date.getDate();
            var m = strArray[date.getMonth()];
            var y = date.getFullYear();
            return '' + (d <= 9 ? '0' + d : d) + ' ' + m + ' ' + y;
        } catch (e) {
            alert('Invalid date');
            return null;
        }
    }

    $('.popoverClass').popover({ trigger: "hover" });
    $('[data-toggle="tooltip"]').tooltip({ placement: "bottom" });

</script>


<link href="~/css/_ApplyLeavePagePopup.css" rel="stylesheet" />