@model Application.Web.Models.LeaveViewModel
@{
    var leaveTypes = @Model.GetAllLeaveTypes();
}
<body>
    <div class="modal fade" id="UpdateLeaveModal" role="dialog">
        <div class="modal-dialog modal-sm" style="width:370px;">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h3 class="modal-title" > Update Leave</h3>
                </div>
                <div id="ModalBody" style="margin-left:9px;margin-right:10px">
                    <div class="col-md-12">
                        <form method="post" asp-controller="Leave" asp-action="ApplyLeave">
                            <div class="col-md-6">
                                <label for="from">From</label>
                                <input type="date" id ="fromDate" class="form-control input-sm"  value=""
                                       min="@DateTime.Today.AddYears(-1).ToString("yyyy-MM-dd")"
                                       max="@DateTime.Today.AddYears(1).ToString("yyyy-MM-dd")"
                                       asp-for="@Model.FromDate"
                                       style="width:150px;"
                                       required>
                            </div>
                            <div class="col-md-6">
                                <label for="to">To</label>
                                <input type="date" id="toDate" class="form-control input-sm" 
                                       min="@DateTime.Today.AddYears(-1).ToString("yyyy-MM-dd")"
                                       max="@DateTime.Today.AddYears(1).ToString("yyyy-MM-dd")"
                                       style="width:150px;"
                                       asp-for="@Model.ToDate"
                                       required>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group" style="width:200px;margin-top:14px;">
                                    <label>Leave Type</label>
                                    <select id="leaveType" name="leaveList" class="form-control input-sm" asp-for="@Model.LeaveType" style="width:150px;">
                                        <option value="-1" disabled selected>select leave type</option>
                                        @foreach (var leave in leaveTypes)
                                        {
                                            <option value="@leave.Key">@leave.Value</option>
                                        }
                                    </select>
                                </div>
                            </div>
                            <div class="col-md-12">
                                <div class="form-group">
                                    <label>Remark</label>
                                    <textarea asp-for="@Model.Remark" class="form-control input-sm" id="remark" placeholder="Remark" rows="6" required></textarea>
                                    <span asp-validation-for="@Model.Remark" class="text-danger input-sm"></span>
                                </div>
                            </div>
                            <div class="form-group">
                                <input type="submit" value="submit" class="btn btn-default btn-info pull-right" />
                            </div>
                        </form>
                    </div>

                </div>
                <div class="modal-footer">
                    <div class="form-group">
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script type="text/javascript">
        $(document).ready(function () {
            var _convertStringToDateObject;

            UpdateLeave = function (laeveId, fromDate, toDate, leaveTypeId, remark) {
                $('#UpdateLeaveModal').modal({ 'show': true, 'backdrop': true });
                alert(fromDate);
                document.getElementById("fromDate").value = convertDateToHtmlFormat(fromDate);
                document.getElementById("toDate").value = convertDateToHtmlFormat(toDate);
                document.getElementById("leaveType").value = leaveTypeId;
                document.getElementById("remark").value = remark ;
            }

        });
    </script>
</body>
<link href="~/css/_ApplyLeavePagePopup.css" rel="stylesheet" />
<script src="~/js/common.helpers.js"></script>
<script>
    function convertDateToHtmlFormat(fromDate) {
        //HTML formt is yyyy-mm-dd
        try {
            fromDate = new Date(fromDate)
            var d = fromDate.getDate();
            var m = fromDate.getMonth()+1;
            var y = fromDate.getFullYear();
            return '' + y + '-' + (m <= 9 ? '0' + m : m) + '-' + (d <= 9 ? '0' + d : d);
        } catch (e) {
            alert('Invalid date');
            return null;
        }
    }
</script>